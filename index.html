<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìê –¢—Ä–∏ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #f0f0f0;
            min-height: 100vh;
            overflow: hidden;
        }

        .workspace {
            position: relative;
            width: 100%;
            height: 100vh;
            background: white;
            cursor: default;
            /* –í–∏–∑—É–∞–ª—å–Ω–∞—è —Å–µ—Ç–∫–∞ –¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–∞ */
            background-image: 
                linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.1) 1px, transparent 1px);
            background-size: 10px 10px;
        }

        .rectangle {
            position: absolute;
            background: #44bec1;
            border: 2px solid #2a8c8f;
            cursor: move;
            user-select: none;
            min-width: 10px;
            min-height: 10px;
        }

        .rectangle.moving {
            cursor: grabbing;
            opacity: 0.9;
        }

        .rectangle.selected {
            border: 2px solid #1a6c6f;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .info-display {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(255,255,255,0.9);
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
            line-height: 1.3;
            pointer-events: none;
            border: 1px solid #ddd;
        }

        .center-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 4px;
            background: red;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }

        .resize-handle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #2a8c8f;
            border: 1px solid white;
            cursor: pointer;
            z-index: 10;
        }

        .resize-handle.top-left {
            top: -4px;
            left: -4px;
            cursor: nw-resize;
        }

        .resize-handle.top-right {
            top: -4px;
            right: -4px;
            cursor: ne-resize;
        }

        .resize-handle.bottom-left {
            bottom: -4px;
            left: -4px;
            cursor: sw-resize;
        }

        .resize-handle.bottom-right {
            bottom: -4px;
            right: -4px;
            cursor: se-resize;
        }

        .instructions {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.9);
            padding: 8px 16px;
            border-radius: 6px;
            text-align: center;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="workspace" id="workspace">
        <!-- –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –∑–¥–µ—Å—å -->
    </div>

    <div class="instructions">
        üñ±Ô∏è –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –º—ã—à—å—é ‚Ä¢ üîÑ –ò–∑–º–µ–Ω—è–π—Ç–µ —Ä–∞–∑–º–µ—Ä –∑–∞ —É–≥–ª—ã ‚Ä¢ üìê –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Å–µ—Ç–∫–µ 10px ‚Ä¢ üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞
    </div>

    <script>
        class RectangleManager {
            constructor() {
                this.workspace = document.getElementById('workspace');
                this.rectangles = [];
                this.selectedRect = null;
                this.gridSize = 10; // –®–∞–≥ —Å–µ—Ç–∫–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
                
                this.createRectangles();
                this.bindEvents();
            }

            // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Å–µ—Ç–∫–µ
            snapToGrid(value) {
                return Math.round(value / this.gridSize) * this.gridSize;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞
            getRectangleCenter(rect) {
                const x = rect.offsetLeft + rect.offsetWidth / 2;
                const y = rect.offsetTop + rect.offsetHeight / 2;
                return { x, y };
            }

            createRectangles() {
                // –°–æ–∑–¥–∞–µ–º —Ç—Ä–∏ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏, –∫—Ä–∞—Ç–Ω—ã–º–∏ 10
                const initialPositions = [
                    { x: 50, y: 50, width: 200, height: 150 },
                    { x: 300, y: 100, width: 180, height: 120 },
                    { x: 150, y: 300, width: 220, height: 100 }
                ];

                initialPositions.forEach((pos, index) => {
                    this.createRectangle(pos.x, pos.y, pos.width, pos.height, index);
                });
            }

            createRectangle(x, y, width, height, id) {
                const rect = document.createElement('div');
                rect.className = 'rectangle';
                rect.dataset.id = id;
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–∏–≤—è–∑–∫—É –∫ —Å–µ—Ç–∫–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
                rect.style.left = this.snapToGrid(x) + 'px';
                rect.style.top = this.snapToGrid(y) + 'px';
                rect.style.width = this.snapToGrid(width) + 'px';
                rect.style.height = this.snapToGrid(height) + 'px';

                // –°–æ–∑–¥–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
                const info = document.createElement('div');
                info.className = 'info-display';
                rect.appendChild(info);

                // –°–æ–∑–¥–∞–µ–º —Ç–æ—á–∫—É –≤ —Ü–µ–Ω—Ç—Ä–µ
                const centerDot = document.createElement('div');
                centerDot.className = 'center-dot';
                rect.appendChild(centerDot);

                // –°–æ–∑–¥–∞–µ–º —Ä—É—á–∫–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
                const resizeHandles = [
                    'top-left', 'top-right', 'bottom-left', 'bottom-right'
                ];

                resizeHandles.forEach(position => {
                    const handle = document.createElement('div');
                    handle.className = `resize-handle ${position}`;
                    rect.appendChild(handle);
                });

                this.workspace.appendChild(rect);
                this.rectangles.push(rect);
                
                this.updateInfo(rect);
                return rect;
            }

            bindEvents() {
                document.addEventListener('mousedown', this.handleMouseDown.bind(this));
                document.addEventListener('mousemove', this.handleMouseMove.bind(this));
                document.addEventListener('mouseup', this.handleMouseUp.bind(this));
            }

            handleMouseDown(e) {
                const rect = e.target.closest('.rectangle');
                const handle = e.target.closest('.resize-handle');

                if (rect) {
                    this.selectRectangle(rect);
                    
                    if (handle) {
                        // –ù–∞—á–∞–ª–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
                        this.startResize(rect, handle.classList[1], e);
                    } else {
                        // –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
                        this.startDrag(rect, e);
                    }
                    e.preventDefault();
                } else {
                    // –ö–ª–∏–∫ –≤–Ω–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ - —Å–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                    this.deselectAll();
                }
            }

            handleMouseMove(e) {
                if (this.draggingRect) {
                    this.onDrag(e);
                } else if (this.resizingRect) {
                    this.onResize(e);
                }
            }

            handleMouseUp() {
                this.draggingRect = null;
                this.resizingRect = null;
                this.resizeDirection = null;
            }

            selectRectangle(rect) {
                this.deselectAll();
                this.selectedRect = rect;
                rect.classList.add('selected');
            }

            deselectAll() {
                this.rectangles.forEach(rect => {
                    rect.classList.remove('selected');
                });
                this.selectedRect = null;
            }

            startDrag(rect, e) {
                this.draggingRect = rect;
                this.dragStartX = e.clientX - rect.offsetLeft;
                this.dragStartY = e.clientY - rect.offsetTop;
            }

            onDrag(e) {
                if (!this.draggingRect) return;

                let newX = e.clientX - this.dragStartX;
                let newY = e.clientY - this.dragStartY;

                // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–∏–≤—è–∑–∫—É –∫ —Å–µ—Ç–∫–µ
                newX = this.snapToGrid(newX);
                newY = this.snapToGrid(newY);

                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏
                const maxX = this.workspace.offsetWidth - this.draggingRect.offsetWidth;
                const maxY = this.workspace.offsetHeight - this.draggingRect.offsetHeight;

                this.draggingRect.style.left = Math.max(0, Math.min(newX, maxX)) + 'px';
                this.draggingRect.style.top = Math.max(0, Math.min(newY, maxY)) + 'px';
                
                this.updateInfo(this.draggingRect);
            }

            startResize(rect, direction, e) {
                this.resizingRect = rect;
                this.resizeDirection = direction;
                
                this.initialRect = {
                    width: rect.offsetWidth,
                    height: rect.offsetHeight,
                    left: rect.offsetLeft,
                    top: rect.offsetTop,
                    mouseX: e.clientX,
                    mouseY: e.clientY
                };
            }

            onResize(e) {
                if (!this.resizingRect) return;

                const deltaX = e.clientX - this.initialRect.mouseX;
                const deltaY = e.clientY - this.initialRect.mouseY;
                
                let newWidth = this.initialRect.width;
                let newHeight = this.initialRect.height;
                let newLeft = this.initialRect.left;
                let newTop = this.initialRect.top;

                // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã (–∫—Ä–∞—Ç–Ω—ã–µ 10)
                const minSize = 10;

                switch (this.resizeDirection) {
                    case 'top-left':
                        newWidth = Math.max(minSize, this.initialRect.width - deltaX);
                        newHeight = Math.max(minSize, this.initialRect.height - deltaY);
                        newLeft = this.initialRect.left + (this.initialRect.width - newWidth);
                        newTop = this.initialRect.top + (this.initialRect.height - newHeight);
                        break;
                    case 'top-right':
                        newWidth = Math.max(minSize, this.initialRect.width + deltaX);
                        newHeight = Math.max(minSize, this.initialRect.height - deltaY);
                        newTop = this.initialRect.top + (this.initialRect.height - newHeight);
                        break;
                    case 'bottom-left':
                        newWidth = Math.max(minSize, this.initialRect.width - deltaX);
                        newHeight = Math.max(minSize, this.initialRect.height + deltaY);
                        newLeft = this.initialRect.left + (this.initialRect.width - newWidth);
                        break;
                    case 'bottom-right':
                        newWidth = Math.max(minSize, this.initialRect.width + deltaX);
                        newHeight = Math.max(minSize, this.initialRect.height + deltaY);
                        break;
                }

                // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–∏–≤—è–∑–∫—É –∫ —Å–µ—Ç–∫–µ –∫–æ –≤—Å–µ–º –∑–Ω–∞—á–µ–Ω–∏—è–º
                newWidth = this.snapToGrid(newWidth);
                newHeight = this.snapToGrid(newHeight);
                newLeft = this.snapToGrid(newLeft);
                newTop = this.snapToGrid(newTop);

                // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ—Ç –ª–µ–≤–æ–≥–æ/–≤–µ—Ä—Ö–Ω–µ–≥–æ –∫—Ä–∞—è
                if (this.resizeDirection === 'top-left' || this.resizeDirection === 'bottom-left') {
                    const actualWidth = this.snapToGrid(this.initialRect.width - (newLeft - this.initialRect.left));
                    newWidth = Math.max(minSize, actualWidth);
                }

                if (this.resizeDirection === 'top-left' || this.resizeDirection === 'top-right') {
                    const actualHeight = this.snapToGrid(this.initialRect.height - (newTop - this.initialRect.top));
                    newHeight = Math.max(minSize, actualHeight);
                }

                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏
                const maxWidth = this.workspace.offsetWidth - newLeft;
                const maxHeight = this.workspace.offsetHeight - newTop;

                newWidth = Math.min(newWidth, maxWidth);
                newHeight = Math.min(newHeight, maxHeight);

                this.resizingRect.style.width = newWidth + 'px';
                this.resizingRect.style.height = newHeight + 'px';
                this.resizingRect.style.left = newLeft + 'px';
                this.resizingRect.style.top = newTop + 'px';
                
                this.updateInfo(this.resizingRect);
            }

            updateInfo(rect) {
                const info = rect.querySelector('.info-display');
                const center = this.getRectangleCenter(rect);
                const width = rect.offsetWidth;
                const height = rect.offsetHeight;

                info.innerHTML = `
                    –¶–µ–Ω—Ç—Ä X: ${Math.round(center.x)}px<br>
                    –¶–µ–Ω—Ç—Ä Y: ${Math.round(center.y)}px<br>
                    –®–∏—Ä–∏–Ω–∞: ${width}px<br>
                    –í—ã—Å–æ—Ç–∞: ${height}px<br>
                    <small>üìê –°–µ—Ç–∫–∞ 10px</small>
                `;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–≥–¥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è
        document.addEventListener('DOMContentLoaded', () => {
            new RectangleManager();
        });
    </script>
</body>
</html>
